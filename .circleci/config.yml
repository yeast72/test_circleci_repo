# Javascript Node CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-javascript/ for more details
#
version: 2.1

jobs:
  test:
    docker:
      - image: circleci/node:10.16.2
    steps:
      - checkout
      - run:
          name: Determine which directories have changed
          command: |
            ./a.sh
            # git diff --no-commit-id --name-only master | cut -d/ -f1 | sort -u >  projects
            # printf "Modified directories:\n"
            # cat projects
          # while read project; do
          #     if grep -Fxq $project projects.txt; then
          #       printf "\nTriggerring build for dir: "$dir
          #       curl -s -u ${CIRCLE_TOKEN}: \
          #         -d build_parameters[CIRCLE_JOB]=${project} \                https://circleci.com/api/v1.1/project/github/$O/$R/tree/$CIRCLE_BRANCH

  app1:
    docker:
      - image: circleci/node:10.16.2
    steps:
      - checkout
      - run:
          name: test app1
          command: |
            cd app1 
            yarn 
            yarn test
  app2:
    docker:
      - image: circleci/node:10.16.2
    steps:
      - checkout
      - run:
          name: test app2
          command: |
            cd app2
            yarn
            yarn test

# workflows:
#   version: 2
#   build_and_test:
#     jobs:
#       - app1
#       - app2:
